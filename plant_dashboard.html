<!DOCTYPE html>  
<html lang="en">   
 
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />  
<meta name="viewport" content="width=device-width, minimum-scale=1.0" /> 
<meta name="description" content="Garden Viewer" />
<link rel="icon" type="image/png" href="plant-icon-96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="plant-icon-96.svg" />
<link rel="shortcut icon" href="plant-club.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="plant-icon-192.png" />
<meta name="apple-mobile-web-app-title" content="Garden Viewer" />
<link rel="manifest" href="plant_club.webmanifest" />
<link rel="stylesheet" type="text/css" href="seed_library.css" />
<script type="text/javascript" src='common_func.js'> </script>
<title>Garden Viewer</title>
</head>

<body>
<script>
let winurlstr = window.location.href;
let winurlsearchstr = window.location.search;
let winurlexsearchstr  = winurlstr.replace(winurlsearchstr,'');
let winurlparams       = new URLSearchParams(winurlsearchstr.substring(1));
let p_params           = winurlparams.get('params') || 'rw';

let config = '';
let configs = [];
 
</script> 
<script src="https://cdn.jsdelivr.net/gh/stockslager/inat/library_params_v4.js"></script>
<script> 
 
function setUpDefaults(configurations) {

   if( configurations.length === 0 ) {
       faddelem('p',document.body,{innerText:'Configuration file ('+p_params+'.json) contains no valid configurations.'});
       faddelem('p',document.body,{innerText:'There are no configurations specified in '+p_params+'.json'});
       faddelem('p',document.body,{innerText:'Please add at least one valid configuration to '+p_params+'.json'});
       throw new Error('No configurations defined.');
   }
   configs = configurations;
   config  = configurations[0];
}

function buildMenu(configs) {
      let menu_string = '';
      let params = '';

      if( p_params )         { params      += '?params='+p_params; }   

      menu_string = '<div class="navbar">';
      menu_string += buildDDTitle('');

      menu_string += buildHome(furl(github_root+'plant_dashboard.html?params='+p_params,'<span style="font_size: 16px;">Help</span>'));
      menu_string += '</div>';
 
      faddelem('p',document.body,{innerHTML:(menu_string)});  
}

function buildTable() {
      
      faddelem('p',document.body,{innerHTML:'total modes: 2 <br/>'
                 +'per page: 10<br />'
                 +'page: 1 of 1<br />'});  
 
      let labels = [];

      labels = [
            {innerText:'Icon'},
            {innerText:'Role'},
            {innerText:'Description'}, 
      ];

      let table = faddelem('table',document.body,{id:'main'});                    
      let thead = faddelem('thead',table);
      let hrow = faddelem('tr',thead);
      
      faddelems('th',hrow,labels);
      let tbody = faddelem('tbody',table);
      let brow = '';
      let values = [];

      if( config.plant_project || config.plant_ids ) {
          brow = faddelem('tr',tbody);
          values = [
                  {innerHTML:furl(github_root+'plant_list.html?params='+p_params+'&mode=pro_visitor','&#127807;')},
                  {innerHTML:furl(github_root+'plant_list.html?params='+p_params+'&mode=pro_visitor','Visitors')},
                  {innerText:'Shows the Southwest Ohio wildlife activity observed occurring on each hilighted native in each garden.'},
                ];
          faddelems('td',brow,values);
      }

      if( config.observers_project ) {
          brow = faddelem('tr',tbody);
          values = [
                  {innerHTML:furl(github_root+'plant_activity_observers.html?project_id='+config.insect_project+'&params='+p_params+'&mode=pro_explorer','&#128100;')},
                  {innerHTML:furl(github_root+'plant_activity_observers.html?project_id='+config.insect_project+'&params='+p_params+'&mode=pro_explorer','Observers')},
                  {innerText:'Shows the observation and species counts for each observer that shared wildlife activity occurring on a hilighted native species anywhere in Southwest Ohio.'},
                ];
          faddelems('td',brow,values);
      }

      if( config.seed_project ) {
          brow = faddelem('tr',tbody);
          values = [
                  {innerHTML:furl(github_root+'plant_seeds.html?project_id='+config.seed_project+'&params='+p_params+'&mode=pro_seed', '&#x1F330;')},
                  {innerHTML:furl(github_root+'plant_seeds.html?project_id='+config.seed_project+'&params='+p_params+'&mode=pro_seed', 'Seeds')},
                  {innerText:'Shows a seed library with offerings collected from hilighted native parent colonies by our network of collectors.  Also shows any wildlife activity occurring on the parent colonies in the actual garden the seeds were collected from.'},
                ];
          faddelems('td',brow,values);

          brow = faddelem('tr',tbody);
          values = [
                  {innerHTML:'&#x1F331;'},
                  {innerText:'Propagators'},
                  {innerText:'Coming Soon.  Shows the list of plants successfully propagated by each propagator in the network.'},
                ];
          faddelems('td',brow,values);
      }
 
};

fetch((p_params+'.json'))
     .then(response => response.json())
     .then(data => {
        // Access your data here 
        if( data.configurations ) {
             console.log('setting up defaults...');
             setUpDefaults(data.configurations);
             console.log('building menu...');
             buildMenu(data.configurations);
             console.log('building table...');
             buildTable();         
        }
      })
     .catch(error => {
      faddelem('p',document.body,{innerText:'There was a problem retrieving '+p_params+'.json.'});
      faddelem('p',document.body,{innerText:'A valid configuration file is required to be specified as a url parameter. (e.g. ?params=bugs_cnc).'});
      throw new Error('Error fetching JSON');
});

</script>
</body>

</html>
