<!DOCTYPE html>  
<html lang="en">   
 
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />  
<meta name="viewport" content="width=device-width, minimum-scale=1.0" /> 
<meta name="description" content="Bugs on Plants" />
<link rel="icon" type="image/png" href="favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="favicon.svg" />
<link rel="shortcut icon" href="favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
<meta name="apple-mobile-web-app-title" content="Bugs on Plants" />
<link rel="manifest" href="bugs.webmanifest" />
<link rel="stylesheet" type="text/css" href="seed_library.css" />
<script type="text/javascript" src='common_func.js'> </script>
<title>Bugs on Plants</title>
</head>

<body>
<script>
let winurlstr = window.location.href;
let winurlsearchstr = window.location.search;
let winurlexsearchstr = winurlstr.replace(winurlsearchstr,'');
let winurlparams  = new URLSearchParams(winurlsearchstr.substring(1));
let p_params        = winurlparams.get('params') || 'secret_society';

let configuration = '';
let configs = [];
 
</script> 
<script src="https://cdn.jsdelivr.net/gh/stockslager/inat/library_params_v4.js"></script>
<script> 
 
function setUpDefaults(configurations) {

   if( configurations.length === 0 ) {
       faddelem('p',document.body,{innerText:'Configuration file ('+p_params+'.json) contains no valid configurations.'});
       faddelem('p',document.body,{innerText:'There are no configurations specified in '+p_params+'.json'});
       faddelem('p',document.body,{innerText:'Please add at least one valid configuration to '+p_params+'.json'});
       throw new Error('No configurations defined.');
   }
}

function buildDDTitle( content ) {
  let dd = '<div class="dd_title">' + content +
           '</div>';

  return( dd );
}

function buildMenu(configs) {
      let menu_string = '';
      let params = '';

      if( p_params )         { params      += '?params='+p_params; }   

      menu_string = '<div class="navbar">';
      menu_string += buildDDTitle(' ');

      menu_string += buildHome(furl(github_root+'bugs_dash.html?params='+p_params,'<span>&#63;</span>'));
      menu_string += '</div>';
 
      faddelem('p',document.body,{innerHTML:(menu_string)});  
}

function buildTable() {
      
      faddelem('p',document.body,{innerHTML:'total modes: 2 <br/>'
                 +'per page: 10<br />'
                 +'page: 1 of 1<br />'});  
 
      let labels = [];

      labels = [
            {innerText:'Icon'},
            {innerText:'Mode'},
            {innerText:'Description'}, 
      ];

 console.log('one');
      let table = faddelem('table',document.body,{id:'main'});                    
      let thead = faddelem('thead',table);
      let hrow = faddelem('tr',thead);
      
      faddelems('th',hrow,labels);
      let tbody = faddelem('tbody',table);
console.log('one a');               

      let brow = faddelem('tr',tbody);
      let values = [
                  {innerHTML:'&#128100;'},
                  {innerText:'Explorers'},
                  {innerText:'Observations of wildlife activity on each plant by each explorer.'},
            ];
console.log('one b');
      faddelems('td',brow,values);
 
      brow = faddelem('tr',tbody);
console.log('two');
      values = [
                  {innerHTML:'&#127807;'},
                  {innerText:'Wildlife Activity'},
                  {innerText:'Southwest Ohio wildlife activity observed occurring on each plant for each garden.'},
            ];
      faddelems('td',brow,values);
 console.log('three');
};

fetch((p_params+'.json'))
     .then(response => response.json())
     .then(data => {
        // Access your data here 
        if( data.configurations ) {
             console.log('setting up defaults...');
             setUpDefaults(data.configurations);
             console.log('building menu...');
             buildMenu(data.configurations);
             console.log('building table...');
             buildTable();
             console.log('four');
        }
      })
     .catch(error => {
      faddelem('p',document.body,{innerText:'There was a problem retrieving '+p_params+'.json.'});
      faddelem('p',document.body,{innerText:'A valid configuration file is required to be specified as a url parameter. (e.g. ?params=bugs_cnc).'});
      throw new Error('Error fetching JSON');
});

</script>
</body>

</html>
